---
- name: create droplets for mongo instances
  digital_ocean:
    state: present
    command: droplet
    name: '{{ item.name }}'
    size_id: '{{ size_id }}'
    unique_name: yes
    ssh_key_ids: '{{ my_ssh_key.ssh_key.id }}'
    region_id: '{{ region_ID }}'
    image_id: '{{ image_ID }}'
    api_token: '{{ do_token }}'
  register: mongoDroplets
  loop: '{{ mongoInstances }}'

- name: install Python 2.x
  raw: which python || sudo apt-get update && sudo apt-get install -qq -y python-simplejson
  register: python_check
  changed_when: not python_check.stdout is search('/usr/bin/python')

- name: install pip
  apt:
    name: python-pip
    state: present
    update_cache: yes
